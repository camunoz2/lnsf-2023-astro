---
import Layout from "../layouts/Layout.astro";
import TextTitle from "../components/TextTitle.astro";
import StatIndicator from "../components/StatIndicator.astro";
import SectionTitle from "../components/SectionTitle.astro";
import UnderlineText from "../components/UnderlineText.astro";
import TextCard from "../components/TextCard.astro";
import EventCard from "../components/EventCard.astro";
import FooterArticle from "../components/FooterArticle.astro";
import Info from "../components/Info.astro";
import { MENU_ITEMS } from "../config/menuItems";
import type { Stats } from "../models/stats";
import type { Config } from "../models/config";

const apiEndpoint = import.meta.env.HYGRAPH_ENDPOINT;

const query = {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    query: `
        {
          statistics {
            id
            statName
            statQuantity
          }
          config(where: {id: "cle00dunc3ikr0bkm271oym1e"}) {
            id
            schoolName
            phone
            address
            workingHours
            institutionalSeals
          }
        }`,
  }),
};
const response = await fetch(apiEndpoint, query);
const json = await response.json();

const stats: Stats[] = json.data.statistics;
const config: Config = json.data.config;
---

<Layout title="Liceo Nibaldo Sepúlveda Fernández">
  <div class="container mx-auto pt-12 md:pt-0 pb-20">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
      <TextTitle />
      <img class="hidden md:block" src="/header_img.png" alt="" />
    </div>
  </div>

  <div class="bg-lnsf-blue py-6 md:py-14">
    <div class="container mx-auto">
      <div
        class="grid grid-cols-1 divide-y md:divide-y-0 md:divide-x divide-white/25 md:grid-cols-2 lg:grid-cols-4 items-center justify-center"
      >
        {
          stats.map((stat) => {
            return (
              <StatIndicator number={stat.statQuantity} text={stat.statName} />
            );
          })
        }
      </div>
    </div>
  </div>

  <div class="container mx-auto py-24">
    <div class="py-12">
      <SectionTitle>
        Bienvenidos al
        <UnderlineText>Nibaldo</UnderlineText>
      </SectionTitle>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 py-12">
      {
        config.institutionalSeals.map((item) => {
          return <TextCard title={item.name} body={item.description} />;
        })
      }
    </div>
  </div>

  <div class="container mx-auto py-24">
    <div class="py-12">
      <SectionTitle>
        Calendario de
        <UnderlineText>Actividades</UnderlineText>
      </SectionTitle>
      <p class="text-center my-6 text-lg">
        ¡No te pierdas ninguna novedad! Revisa nuestro sitio regularmente.
      </p>
      <div class="grid grid-cols-2 py-12">
        <img src="/activities_img.png" alt="" />

        <div class="grid grid-cols-1 gap-2 -translate-x-44">
          <EventCard
            title="Salida a la montaña en familia"
            category="Convivencia Escolar"
            date="22 de Diciembre"
            time="12:00"
          />
          <div class="-translate-x-14">
            <EventCard
              title="Brindis con los profesores"
              category="Convivencia ssd"
              date="31 de Febrero"
              time="16:00"
            />
          </div>
          <EventCard
            title="Brindis con los profesores"
            category="Convivencia ssd"
            date="31 de Febrero"
            time="16:00"
          />
        </div>
      </div>
    </div>
  </div>

  <div class="container mx-auto py-12">
    <SectionTitle>
      ¿Qué esperas?
      <UnderlineText>¡Únete al Nibaldo!</UnderlineText>
    </SectionTitle>

    <div class="grid grid-cols-3 gap-4 mt-24">
      <div>
        <h4 class="font-bold mb-10 text-3xl">Conversemos</h4>
        <div class="flex flex-col gap-6">
          <Info icon="/svgTelephone.png" title="Teléfono" info={config.phone} />
          <Info
            icon="/svgTime.png"
            title="Horario de atención"
            info={config.workingHours}
          />
          <Info icon="/svgPin.png" title="Ubicación" info={config.address} />
        </div>
      </div>
      <div>
        <h4 class="font-bold mb-10 text-3xl">Algunos Links</h4>
        <div class="flex flex-col gap-1">
          {
            MENU_ITEMS.map((item) => {
              return (
                <div class="flex gap-2">
                  <span class="text-lnsf-blue">---</span>
                  <p>{item.title}</p>
                </div>
              );
            })
          }
        </div>
      </div>

      <div class="flex flex-col gap-2">
        <h4 class="font-bold mb-10 text-3xl">Noticias</h4>
        <FooterArticle
          title="Brindis en el nibaldo"
          date="12 de Agosto, 2022"
        />
        <FooterArticle title="Otro artículo" date="24 de Julio, 2022" />
      </div>
    </div>
  </div>
</Layout>
